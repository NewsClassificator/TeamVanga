import re

def count_syllables_russian(word):
    """–ü–æ–¥—Å—á—ë—Ç —Å–ª–æ–≥–æ–≤ –ø–æ –≥–ª–∞—Å–Ω—ã–º (–∞, –µ, —ë, –∏, –æ, —É, —ã, —ç, —é, —è)"""
    vowels = '–∞–µ—ë–∏–æ—É—ã—ç—é—è'
    return max(1, sum(1 for char in word.lower() if char in vowels))

def analyze_text_russian(text):
    text = text.strip()
    if not text:
        return {
            "words": 0, "sentences": 0, "syllables": 0,
            "flesch_index": None, "level": "–ü—É—Å—Ç–æ–π —Ç–µ–∫—Å—Ç", "grade": "‚Äî"
        }

    # –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è: –¥–µ–ª–∏–º –ø–æ . ? ! —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ—á–∏—Å—Ç–∫–æ–π
    sentences = re.split(r'[.!?]+', text)
    sentences = [s.strip() for s in sentences if s.strip()]
    num_sentences = len(sentences)

    # –°–ª–æ–≤–∞: —Ç–æ–ª—å–∫–æ –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ (–≤–∫–ª—é—á–∞—è —ë)
    words = re.findall(r'[–∞-—è–ê-–Ø—ë–Å]+(?:-[–∞-—è–ê-–Ø—ë–Å]+)*', text)
    num_words = len(words)

    if num_words == 0:
        return {
            "words": 0, "sentences": num_sentences, "syllables": 0,
            "flesch_index": None, "level": "–ù–µ—Ç —Å–ª–æ–≤", "grade": "‚Äî"
        }

    total_syllables = sum(count_syllables_russian(word) for word in words)

    # –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
    if num_sentences == 0:
        num_sentences = 1  # –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ –Ω–µ—Ç –∑–Ω–∞–∫–æ–≤ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è

    # –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –§–ª–µ—à–∞ –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
    asl = num_words / num_sentences          # —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (–≤ —Å–ª–æ–≤–∞—Ö)
    asw = total_syllables / num_words        # —Å—Ä–µ–¥–Ω–µ–µ —á–∏—Å–ª–æ —Å–ª–æ–≥–æ–≤ –Ω–∞ —Å–ª–æ–≤–æ

    flesch_index = 208.7 - 1.11 * asl - 63.5 * asw
    flesch_index = max(0.0, min(100.0, round(flesch_index, 2)))  # –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω

    # –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–∞ (–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥ —Ä—É—Å—Å–∫–∏–π)
    if flesch_index >= 90:
        level = "–æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è"
        grade = "–Ω–∞—á–∞–ª—å–Ω–∞—è —à–∫–æ–ª–∞ (1‚Äì4 –∫–ª–∞—Å—Å—ã)"
    elif flesch_index >= 80:
        level = "–≤—ã—Å–æ–∫–∞—è"
        grade = "—Å—Ä–µ–¥–Ω—è—è —à–∫–æ–ª–∞ (5‚Äì6 –∫–ª–∞—Å—Å—ã)"
    elif flesch_index >= 70:
        level = "–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è"
        grade = "—Å—Ä–µ–¥–Ω—è—è —à–∫–æ–ª–∞ (7‚Äì8 –∫–ª–∞—Å—Å—ã)"
    elif flesch_index >= 60:
        level = "—Å—Ä–µ–¥–Ω—è—è"
        grade = "—Å—Ç–∞—Ä—à–∏–µ –∫–ª–∞—Å—Å—ã (9‚Äì11)"
    elif flesch_index >= 50:
        level = "–Ω–∏–∑–∫–∞—è"
        grade = "—Å—Ç—É–¥–µ–Ω—Ç—ã"
    elif flesch_index >= 30:
        level = "–æ—á–µ–Ω—å –Ω–∏–∑–∫–∞—è"
        grade = "–≤—ã—Å—à–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"
    else:
        level = "–∫—Ä–∞–π–Ω–µ –Ω–∏–∑–∫–∞—è"
        grade = "–Ω–∞—É—á–Ω—ã–µ/—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã"

    return {
        "words": num_words,
        "sentences": num_sentences,
        "syllables": total_syllables,
        "flesch_index": flesch_index,
        "level": level,
        "grade": grade
    }

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
if __name__ == "__main__":
    text = """
    –õ–æ—à–∞–¥–∫–∞ –≤–µ–∑–ª–∞ –≤–æ–∑ —Ö–≤–æ—Ä–æ—Å—Ç–∞. –ë—ã–ª —Å–∏–ª—å–Ω—ã–π –º–æ—Ä–æ–∑. –ö—Ä–µ—Å—Ç—å—è–Ω–∏–Ω –µ—Ö–∞–ª –Ω–∞ –±–∞–∑–∞—Ä.
    """

    res = analyze_text_russian(text)
    print("üî§ –ê–Ω–∞–ª–∏–∑ —Ä—É—Å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞:")
    for k, v in res.items():
        print(f"{k.capitalize()}: {v}")
