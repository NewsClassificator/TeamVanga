import re

def count_syllables_russian(word):
    """–ü–æ–¥—Å—á—ë—Ç —Å–ª–æ–≥–æ–≤ –≤ —Å–ª–æ–≤–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≥–ª–∞—Å–Ω—ã—Ö"""
    vowels = '–∞–µ—ë–∏–æ—É—ã—ç—é—è'
    return sum(1 for char in word.lower() if char in vowels)

def analyze_text_russian(text):
    # –£–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ç–µ–∫—Å—Ç
    text = text.strip()

    # –ü–æ–¥—Å—á—ë—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π: —Ä–∞–∑–¥–µ–ª—è–µ–º –ø–æ . ? !
    sentences = re.split(r'[.!?]+', text)
    sentences = [s.strip() for s in sentences if s.strip()]
    num_sentences = len(sentences)

    # –ü–æ–¥—Å—á—ë—Ç —Å–ª–æ–≤: –∏–∑–≤–ª–µ–∫–∞–µ–º —Å–ª–æ–≤–∞ (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞ + –¥–µ—Ñ–∏—Å—ã + –∞–ø–æ—Å—Ç—Ä–æ—Ñ—ã)
    words = re.findall(r'[–∞-—è–ê-–Ø—ë–Å]+(?:-[–∞-—è–ê-–Ø—ë–Å]+)*', text)
    num_words = len(words)

    # –ü–æ–¥—Å—á—ë—Ç —Å–ª–æ–≥–æ–≤
    total_syllables = sum(count_syllables_russian(word) for word in words)

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
    if num_sentences == 0 or num_words == 0:
        return {
            "words": num_words,
            "sentences": num_sentences,
            "syllables": total_syllables,
            "flesch_index": None,
            "level": "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö",
            "grade": "‚Äî"
        }

    # –§–æ—Ä–º—É–ª–∞ –§–ª–µ—à–∞ (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥ —Ä—É—Å—Å–∫–∏–π)
    # –ò–Ω–¥–µ–∫—Å –§–ª–µ—à–∞ = 206.835 - 1.3 * (–∫–æ–ª-–≤–æ —Å–ª–æ–≤ / –∫–æ–ª-–≤–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π) - 60.1 * (–∫–æ–ª-–≤–æ —Å–ª–æ–≥–æ–≤ / –∫–æ–ª-–≤–æ —Å–ª–æ–≤)
    flesch_index = 206.835 - 1.3 * (num_words / num_sentences) - 60.1 * (total_syllables / num_words)

    # –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ 2 –∑–Ω–∞–∫–æ–≤
    flesch_index = round(flesch_index, 2)

    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è —É–¥–æ–±–æ—á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
    if flesch_index >= 90:
        level = "–æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π"
        grade = "5 –∫–ª–∞—Å—Å–æ–≤"
    elif flesch_index >= 80:
        level = "–≤—ã—Å–æ–∫–∏–π"
        grade = "6 –∫–ª–∞—Å—Å–æ–≤"
    elif flesch_index >= 70:
        level = "–≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ"
        grade = "7 –∫–ª–∞—Å—Å–æ–≤"
    elif flesch_index >= 60:
        level = "—Å—Ä–µ–¥–Ω–∏–π"
        grade = "8‚Äì9 –∫–ª–∞—Å—Å–æ–≤"
    elif flesch_index >= 50:
        level = "–Ω–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ"
        grade = "10‚Äì12 –∫–ª–∞—Å—Å–æ–≤"
    elif flesch_index >= 30:
        level = "–Ω–∏–∑–∫–∏–π"
        grade = "–≤—É–∑"
    else:
        level = "–æ—á–µ–Ω—å –Ω–∏–∑–∫–∏–π"
        grade = "–≤—ã–ø—É—Å–∫–Ω–∏–∫ –≤—É–∑–∞"

    return {
        "words": num_words,
        "sentences": num_sentences,
        "syllables": total_syllables,
        "flesch_index": flesch_index,
        "level": level,
        "grade": grade
    }

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
if __name__ == "__main__":
    sample_text = """
    –û–¥–Ω–∞–∂–¥—ã –≤ —Å—Ç—É–¥—ë–Ω—É—é –∑–∏–º–Ω—é—é –ø–æ—Ä—É
    –Ø –∏–∑ –ª–µ—Å—É –≤—ã—à–µ–ª; –±—ã–ª —Å–∏–ª—å–Ω—ã–π –º–æ—Ä–æ–∑.
    –ì–ª—è–∂—É, –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ –≤ –≥–æ—Ä—É
    –õ–æ—à–∞–¥–∫–∞, –≤–µ–∑—É—â–∞—è —Ö–≤–æ—Ä–æ—Å—Ç–∞ –≤–æ–∑.
    –ó–∏–º–∞. –ö—Ä–µ—Å—Ç—å—è–Ω–∏–Ω, —Ç–æ—Ä–æ–ø—è—Å—å –Ω–∞ –±–∞–∑–∞—Ä,
    –ù–∞ –±–µ–ª–æ–π –ª–æ—à–∞–¥–∫–µ —Å–∫–∞–∫–∞–ª –Ω–∞ –±–∞–∑–∞—Ä.
    """

    result = analyze_text_russian(sample_text)

    print("üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞:")
    print(f"–°–ª–æ–≤: {result['words']}")
    print(f"–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π: {result['sentences']}")
    print(f"–°–ª–æ–≥–æ–≤: {result['syllables']}")
    print(f"–ò–Ω–¥–µ–∫—Å –§–ª–µ—à–∞: {result['flesch_index']}")
    print(f"–£—Ä–æ–≤–µ–Ω—å —É–¥–æ–±–æ—á–∏—Ç–∞–µ–º–æ—Å—Ç–∏: {result['level']}")
    print(f"–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è: {result['grade']}")
